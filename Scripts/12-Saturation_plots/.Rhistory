suppressMessages(library("Cairo"))
suppressMessages(options(bitmapType='cairo'))
suppressMessages(library("ggplot2"))
## 1. VARIABLES
WD = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/13-saturation_plots"
species = c("csa", "cme", "cla", "cmo", "cpe", "cma")
ranges = c(5, 5, 5, 2, 2, 2)
## 2. FIGURES
cat("\nFIGURES...\n")
if (!dir.exists(paste0(WD, "/ALL"))){
dir.create(paste0(WD, "/ALL"))
}
if (!dir.exists(paste0(WD, "/ALL/Figures_CS"))){
dir.create(paste0(WD, "/ALL/Figures_CS"))
}
cat("\nFigure 1...\n")
Batch_tab_1_RED = data.frame()
for (i in 1:length(species)) {
Batch_tab_1_red = read.table(paste0(WD, "/", species[i], "/Tables_CS/FINAL-Batch_tab_1-", ranges[i], ".tsv"), sep = "\t", header = T, quote = "\"")
Batch_tab_1_RED = rbind(Batch_tab_1_RED, Batch_tab_1_red)
}
View(Batch_tab_1_RED)
Batch_tab_1_RED = data.frame()
for (i in 1:length(species)) {
Batch_tab_1_red = read.table(paste0(WD, "/", species[i], "/Tables_CS/FINAL-Batch_tab_1-", ranges[i], ".tsv"), sep = "\t", header = T, quote = "\"")
Batch_tab_1_red$"Spe" = species[i]
Batch_tab_1_red$"Range" = ranges[i]
Batch_tab_1_RED = rbind(Batch_tab_1_RED, Batch_tab_1_red)
}
Batch_tab_1_RED$Spe = factor(Batch_tab_1_RED$Spe, levels = species)
Batch_tab_1_RED$Class_code = factor(Batch_tab_1_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
Batch_tab_1_RED$Confidence_level = factor(Batch_tab_1_RED$Confidence_level, levels = c("Low", "Medium", "High"))
Batch_tab_1_RED$Spe = factor(Batch_tab_1_RED$Spe, levels = species)
Batch_tab_1_RED$Class_code = factor(Batch_tab_1_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
Batch_tab_1_RED$Confidence_level = factor(Batch_tab_1_RED$Confidence_level, levels = c("Low", "Medium", "High"))
ggplot(Batch_tab_1_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
facet_grid(Confidence_level ~ Spe, scales = 'free') +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b"))
cat("\nFigure 2...\n")
Batch_tab_2_RED = data.frame()
for (i in 1:length(species)) {
Batch_tab_2_red = read.table(paste0(WD, "/", species[i], "/Tables_CS/FINAL-Batch_tab_2-", ranges[i], ".tsv"), sep = "\t", header = T, quote = "\"")
Batch_tab_2_red$"Spe" = species[i]
Batch_tab_2_red$"Range" = ranges[i]
Batch_tab_2_RED = rbind(Batch_tab_2_RED, Batch_tab_2_red)
}
Batch_tab_2_RED$Spe = factor(Batch_tab_2_RED$Spe, levels = species)
Batch_tab_2_RED$Class_code = factor(Batch_tab_2_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
ggplot(Batch_tab_2_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
facet_grid(. ~ Spe, scales = 'free') +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_x_continuous(breaks = seq(range,max(Batch_tab_2_RED$Size),range)) +
xlab("Number of samples") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(legend.position = "bottom")
if (!dir.exists(paste0(WD, "/ALL"))){
dir.create(paste0(WD, "/ALL"))
}
if (!dir.exists(paste0(WD, "/ALL/Figures_CS"))){
dir.create(paste0(WD, "/ALL/Figures_CS"))
}
cat("\nFigure 1...\n")
Batch_tab_1_RED = data.frame()
for (i in 1:length(species)) {
Batch_tab_1_red = read.table(paste0(WD, "/", species[i], "/Tables_CS/FINAL-Batch_tab_1-", ranges[i], ".tsv"), sep = "\t", header = T, quote = "\"")
Batch_tab_1_red$"Spe" = species[i]
Batch_tab_1_red$"Range" = ranges[i]
Batch_tab_1_RED = rbind(Batch_tab_1_RED, Batch_tab_1_red)
}
Batch_tab_1_RED$Spe = factor(Batch_tab_1_RED$Spe, levels = species)
Batch_tab_1_RED$Class_code = factor(Batch_tab_1_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
Batch_tab_1_RED$Confidence_level = factor(Batch_tab_1_RED$Confidence_level, levels = c("Low", "Medium", "High"))
gg1 = ggplot(Batch_tab_1_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
facet_grid(Confidence_level ~ Spe, scales = 'free') +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_x_continuous(breaks = seq(range,max(Batch_tab_1_RED$Size),range)) +
xlab("Number of samples") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(legend.position = "bottom")
ggsave(paste0(WD, "/ALL/Figures_CS/Saturation_curve_1.png"), height = 5, width = 20, dpi = 600)
################################################################################
#
# CREATE THE SATURATION CURVES
#
################################################################################
rm(list = ls())
## 0. INSTALL AND LOAD LIBRARIES
suppressMessages(library("Cairo"))
suppressMessages(options(bitmapType='cairo'))
suppressMessages(library("ggplot2"))
## 1. VARIABLES
WD = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/13-saturation_plots"
species = c("csa", "cme", "cla", "cmo", "cpe", "cma")
ranges = c(5, 5, 5, 2, 2, 2)
## 2. FIGURES
cat("\nFIGURES...\n")
if (!dir.exists(paste0(WD, "/ALL"))){
dir.create(paste0(WD, "/ALL"))
}
if (!dir.exists(paste0(WD, "/ALL/Tables_CS"))){
dir.create(paste0(WD, "/ALL/Tables_CS"))
}
if (!dir.exists(paste0(WD, "/ALL/Figures_CS"))){
dir.create(paste0(WD, "/ALL/Figures_CS"))
}
cat("\nFigure 1...\n")
Batch_tab_1_RED = data.frame()
for (i in 1:length(species)) {
Batch_tab_1_red = read.table(paste0(WD, "/", species[i], "/Tables_CS/FINAL-Batch_tab_1-", ranges[i], ".tsv"), sep = "\t", header = T, quote = "\"")
Batch_tab_1_red$"Spe" = species[i]
Batch_tab_1_red$"Range" = ranges[i]
Batch_tab_1_RED = rbind(Batch_tab_1_RED, Batch_tab_1_red)
}
write.table(Batch_tab_1_RED, paste0(WD, "/ALL/Tables_CS/FINAL-Batch_tab_1.tsv"), col.names = T, row.names = F, quote = F)
Batch_tab_1_RED$Spe = factor(Batch_tab_1_RED$Spe, levels = species)
Batch_tab_1_RED$Class_code = factor(Batch_tab_1_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
Batch_tab_1_RED$Confidence_level = factor(Batch_tab_1_RED$Confidence_level, levels = c("Low", "Medium", "High"))
gg1 = ggplot(Batch_tab_1_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
facet_grid(Confidence_level ~ Spe, scales = 'free') +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b")) +
xlab("Number of samples") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(legend.position = "bottom")
ggsave(paste0(WD, "/ALL/Figures_CS/Saturation_curve_1.png"), height = 5, width = 20, dpi = 600)
cat("\nFigure 2...\n")
Batch_tab_2_RED = data.frame()
for (i in 1:length(species)) {
Batch_tab_2_red = read.table(paste0(WD, "/", species[i], "/Tables_CS/FINAL-Batch_tab_2-", ranges[i], ".tsv"), sep = "\t", header = T, quote = "\"")
Batch_tab_2_red$"Spe" = species[i]
Batch_tab_2_red$"Range" = ranges[i]
Batch_tab_2_RED = rbind(Batch_tab_2_RED, Batch_tab_2_red)
}
write.table(Batch_tab_2_RED, paste0(WD, "/ALL/Tables_CS/FINAL-Batch_tab_2.tsv"), col.names = T, row.names = F, quote = F)
Batch_tab_2_RED$Spe = factor(Batch_tab_2_RED$Spe, levels = species)
Batch_tab_2_RED$Class_code = factor(Batch_tab_2_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
gg2 = ggplot(Batch_tab_2_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
facet_grid(. ~ Spe, scales = 'free') +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b")) +
xlab("Number of samples") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(legend.position = "bottom")
ggsave(paste0(WD, "/ALL/Figures_CS/Saturation_curve_2.png"), height = 5, width = 18, dpi = 600)
rm(list = c("gg1", "gg2"))
gg1 = ggplot(Batch_tab_1_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
facet_grid(Confidence_level ~ Spe, scales = 'free') +
scale_y_break(breaks=c(8000, 22000), scales = 0.15, expand = T) +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b")) +
xlab("Number of samples") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(legend.position = "bottom")
suppressMessages(library("Cairo"))
suppressMessages(options(bitmapType='cairo'))
suppressMessages(library("ggplot2"))
suppressMessages(library("ggbreak"))
Batch_tab_1_RED$Spe = factor(Batch_tab_1_RED$Spe, levels = species)
Batch_tab_1_RED$Class_code = factor(Batch_tab_1_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
Batch_tab_1_RED$Confidence_level = factor(Batch_tab_1_RED$Confidence_level, levels = c("Low", "Medium", "High"))
gg1 = ggplot(Batch_tab_1_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
facet_grid(Confidence_level ~ Spe, scales = 'free') +
scale_y_break(breaks=c(8000, 22000), scales = 0.15, expand = T) +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b")) +
xlab("Number of samples") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(legend.position = "bottom")
ggsave(paste0(WD, "/ALL/Figures_CS/Saturation_curve_1.png"), height = 5, width = 20, dpi = 600)
gg2 = ggplot(Batch_tab_2_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
facet_grid(. ~ Spe, scales = 'free') +
scale_y_break(breaks=c(8000, 22000), scales = 0.15, expand = T) +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b")) +
xlab("Number of samples") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(legend.position = "bottom")
ggsave(paste0(WD, "/ALL/Figures_CS/Saturation_curve_2.png"), height = 5, width = 18, dpi = 600)
################################################################################
#
# CREATE THE SATURATION CURVES
#
################################################################################
rm(list = ls())
## 0. INSTALL AND LOAD LIBRARIES
suppressMessages(library("Cairo"))
suppressMessages(options(bitmapType='cairo'))
suppressMessages(library("ggplot2"))
suppressMessages(library("ggbreak"))
## 1. VARIABLES
WD = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/13-saturation_plots"
species = c("csa", "cme", "cla", "cmo", "cpe", "cma")
ranges = c(5, 5, 5, 2, 2, 2)
## 2. FIGURES
cat("\nFIGURES...\n")
if (!dir.exists(paste0(WD, "/ALL"))){
dir.create(paste0(WD, "/ALL"))
}
if (!dir.exists(paste0(WD, "/ALL/Tables_CS"))){
dir.create(paste0(WD, "/ALL/Tables_CS"))
}
if (!dir.exists(paste0(WD, "/ALL/Figures_CS"))){
dir.create(paste0(WD, "/ALL/Figures_CS"))
}
cat("\nFigure 1...\n")
Batch_tab_1_RED = data.frame()
for (i in 1:length(species)) {
Batch_tab_1_red = read.table(paste0(WD, "/", species[i], "/Tables_CS/FINAL-Batch_tab_1-", ranges[i], ".tsv"), sep = "\t", header = T, quote = "\"")
Batch_tab_1_red$"Spe" = species[i]
Batch_tab_1_red$"Range" = ranges[i]
Batch_tab_1_RED = rbind(Batch_tab_1_RED, Batch_tab_1_red)
}
write.table(Batch_tab_1_RED, paste0(WD, "/ALL/Tables_CS/FINAL-Batch_tab_1.tsv"), col.names = T, row.names = F, quote = F)
Batch_tab_1_RED$Spe = factor(Batch_tab_1_RED$Spe, levels = species)
Batch_tab_1_RED$Class_code = factor(Batch_tab_1_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
Batch_tab_1_RED$Confidence_level = factor(Batch_tab_1_RED$Confidence_level, levels = c("Low", "Medium", "High"))
gg1 = ggplot(Batch_tab_1_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
facet_grid(Confidence_level ~ Spe, scales = 'free') +
#scale_y_break(breaks=c(8000, 22000), scales = 0.15, expand = T) +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b")) +
xlab("Number of samples") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(legend.position = "bottom")
ggsave(paste0(WD, "/ALL/Figures_CS/Saturation_curve_1.png"), height = 5, width = 20, dpi = 600)
cat("\nFigure 2...\n")
Batch_tab_2_RED = data.frame()
for (i in 1:length(species)) {
Batch_tab_2_red = read.table(paste0(WD, "/", species[i], "/Tables_CS/FINAL-Batch_tab_2-", ranges[i], ".tsv"), sep = "\t", header = T, quote = "\"")
Batch_tab_2_red$"Spe" = species[i]
Batch_tab_2_red$"Range" = ranges[i]
Batch_tab_2_RED = rbind(Batch_tab_2_RED, Batch_tab_2_red)
}
write.table(Batch_tab_2_RED, paste0(WD, "/ALL/Tables_CS/FINAL-Batch_tab_2.tsv"), col.names = T, row.names = F, quote = F)
Batch_tab_2_RED$Spe = factor(Batch_tab_2_RED$Spe, levels = species)
Batch_tab_2_RED$Class_code = factor(Batch_tab_2_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
gg2 = ggplot(Batch_tab_2_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
facet_grid(. ~ Spe, scales = 'free') +
#scale_y_break(breaks=c(8000, 22000), scales = 0.15, expand = T) +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b")) +
xlab("Number of samples") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(legend.position = "bottom")
ggsave(paste0(WD, "/ALL/Figures_CS/Saturation_curve_2.png"), height = 5, width = 18, dpi = 600)
rm(list = c("gg1", "gg2"))
