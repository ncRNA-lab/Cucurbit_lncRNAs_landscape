suppressMessages(library("ggplot2"))
WD = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/13-saturation_plots/car"
range = 5
cat("\nFIGURES...\n")
cat("\nFigure 1...\n")
Batch_tab_1_RED = read.table(paste0(WD, "/Tables/FINAL-Batch_tab_1-", range, ".tsv"), sep = "\t", header = T, quote = "\"")
range = 2
cat("\nFIGURES...\n")
cat("\nFigure 1...\n")
Batch_tab_1_RED = read.table(paste0(WD, "/Tables/FINAL-Batch_tab_1-", range, ".tsv"), sep = "\t", header = T, quote = "\"")
Batch_tab_1_RED$Class_code = factor(Batch_tab_1_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
Batch_tab_1_RED$Confidence_level = factor(Batch_tab_1_RED$Confidence_level, levels = c("Low", "Medium", "High"))
View(Batch_tab_1_RED)
cat("\nFIGURES...\n")
if (!dir.exists(paste0(WD, "/Figures_CS"))){
dir.create(paste0(WD, "/Figures_CS"))
}
cat("\nFigure 1...\n")
Batch_tab_1_RED = read.table(paste0(WD, "/Tables/FINAL-Batch_tab_1-", range, ".tsv"), sep = "\t", header = T, quote = "\"")
Batch_tab_1_RED$Class_code = factor(Batch_tab_1_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
Batch_tab_1_RED$Confidence_level = factor(Batch_tab_1_RED$Confidence_level, levels = c("Low", "Medium", "High"))
length(unique(Batch_tab_1_RED$Batch))
gg1 = ggplot(Batch_tab_1_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
facet_grid(Confidence_level ~ ., scales = 'free') +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b")) +
scale_x_continuous(breaks = seq(range,range*length(unique(Batch_tab_1_RED$Batch)),range)) +
xlab("Number of samples") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(legend.position = "bottom")
ggsave(paste0(WD, "/Figures_CS/Saturation_curve_1.png"), height = 10, width = 10, dpi = 600)
Batch_tab_2_RED = read.table(paste0(WD, "/Tables/FINAL-Batch_tab_2-", range, ".tsv"), sep = "\t", header = T, quote = "\"")
Batch_tab_2_RED$Class_code = factor(Batch_tab_2_RED$Class_code, levels = c("intergenic (u)", "antisense (x)", "intronic (i)", "sense (o/e)"))
gg2 = ggplot(Batch_tab_2_RED, aes(x = Size, y = Mean.Counts, color = Class_code)) +
geom_point() +
geom_line() +
scale_color_manual(values = c("#ece68f", "#decfa9", "#dcb8b8", "#b5cf9b")) +
scale_x_continuous(breaks = seq(range,range*length(unique(Batch_tab_2_RED$Batch)),range)) +
xlab("Number of samples") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(legend.position = "bottom")
ggsave(paste0(WD, "/Figures_CS/Saturation_curve_2.png"), height = 6, width = 6, dpi = 600)
