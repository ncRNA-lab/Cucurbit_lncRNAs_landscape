#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 36000), breaks = seq(0, 36000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(14000, 26000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
guides(fill=guide_legend(title="Confidence level")) +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 14),
axis.text.y = element_text(size = 14),
axis.title.y = element_text(size = 15),
strip.text.x = element_text(size = 17, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.text = element_text(size = 14),
legend.title = element_text(size = 14))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_R.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_R.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
### Non-Redundant
TAB_red_NR = TAB_NR[,c("ID_transcript", "Significance_level", "Class_code", "Specie")]
TAB_red_NR$"Counts" = 1
TAB_red_NR[TAB_red_NR == "o"] = "o/e"
TAB_red_NR[TAB_red_NR == "e"] = "o/e"
TAB_red_NR$Class_code = factor(TAB_red_NR$Class_code, levels = c("u", "x", "i", "o/e"))
TAB_red_NR$Significance_level = factor(TAB_red_NR$Significance_level, levels = c("Low", "Medium", "High"))
TAB_red_NR$Specie = factor(TAB_red_NR$Specie, levels = species_long_name)
Tab_FINAL_NR = TAB_red_NR %>%
group_by(Specie, Significance_level, Class_code, .drop=FALSE) %>%
summarise(
sum.Counts = sum(Counts))
Tab_FINAL_NR = as.data.frame(Tab_FINAL_NR)
write.table(Tab_FINAL_NR, paste0(WD, "/ALL/Database_LncRNAs_FINAL_NR-all_species"), sep = "\t", col.names = T, row.names = F, quote = F)
gg = ggplot(Tab_FINAL_NR, aes(x = Class_code, y = sum.Counts, fill = Significance_level)) +
geom_bar(position="stack", stat="identity") +
#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 25000), breaks = seq(0, 25000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(8000, 20000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
guides(fill=guide_legend(title="Confidence level")) +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 14),
axis.text.y = element_text(size = 14),
axis.title.y = element_text(size = 15),
strip.text.x = element_text(size = 17, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.text = element_text(size = 14),
legend.title = element_text(size = 14))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
##############################
# Draw Non-Redundant figure with the Redundant figure axis dimensions (Execute and then mute)
gg = ggplot(Tab_FINAL_NR, aes(x = Class_code, y = sum.Counts, fill = Significance_level)) +
geom_bar(position="stack", stat="identity") +
#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 25000), breaks = seq(0, 25000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(14000, 18000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
guides(fill=guide_legend(title="Confidence level")) +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 14),
axis.text.y = element_text(size = 14),
axis.title.y = element_text(size = 15),
strip.text.x = element_text(size = 17, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.text = element_text(size = 14),
legend.title = element_text(size = 14))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR_keep_axis.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR_keep_axis.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
View(Tab_FINAL_NR)
View(Tab_FINAL_NR)
View(TAB_R)
################################################################################
#
# JOIN TABLES AND FIGURES
#
################################################################################
rm(list = ls())
## 0. INSTALL AND LOAD LIBRARIES
suppressMessages(options(bitmapType='cairo'))
suppressMessages(library("ggplot2"))
suppressMessages(library("ggbreak"))
suppressMessages(library("dplyr"))
## 1. VARIABLES
WD = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/05-predict_lncRNAs"
species_short_name = c("csa", "cme", "cla", "lsi", "cmo", "car", "cpe", "cma", "mch")
species_long_name = c("C. sativus", "C. melo", "C. lanatus", "L. siceraria", "C. moschata", "C. argyrosperma", "C. pepo", "C. maxima", "M. charantia")
if (!dir.exists(paste0(WD, "/ALL"))){
dir.create(paste0(WD, "/ALL"))
}
## 2. JOIN THE LNCRNAS DATABASE
TAB_R = data.frame()
TAB_NR = data.frame()
for (i in 1:length(species_short_name)) {
tab_R = read.table(paste0(WD, "/", species_short_name[i], "/STEP-FINAL/Database/Database_LncRNAs.tsv"), sep = "\t", header = T, quote = "\"")
tab_R$"Specie" = species_long_name[i]
tab_NR = read.table(paste0(WD, "/", species_short_name[i], "/STEP-FINAL/Database/Database_LncRNAs_NR.tsv"), sep = "\t", header = T, quote = "\"")
tab_NR$"Specie" = species_long_name[i]
TAB_R = rbind(TAB_R, tab_R)
TAB_NR = rbind(TAB_NR, tab_NR)
}
write.table(TAB_R, paste0(WD, "/ALL/Database_LncRNAs_R-all_species.tsv"), sep = "\t", col.names = T, row.names = F, quote = F)
write.table(TAB_NR, paste0(WD, "/ALL/Database_LncRNAs_NR-all_species.tsv"), sep = "\t", col.names = T, row.names = F, quote = F)
rm(list = c("i", "tab_R", "tab_NR"))
## 3. FIGURES
### Redundant
TAB_red_R = TAB_R[,c("ID_transcript", "Significance_level", "Class_code", "Specie")]
TAB_red_R$"Counts" = 1
TAB_red_R[TAB_red_R == "o"] = "o/e"
TAB_red_R[TAB_red_R == "e"] = "o/e"
TAB_red_R$Class_code = factor(TAB_red_R$Class_code, levels = c("u", "x", "i", "o/e"))
TAB_red_R$Significance_level = factor(TAB_red_R$Significance_level, levels = c("Low", "Medium", "High"))
TAB_red_R$Specie = factor(TAB_red_R$Specie, levels = species_long_name)
Tab_FINAL_R = TAB_red_R %>%
group_by(Specie, Significance_level, Class_code, .drop=FALSE) %>%
summarise(
sum.Counts = sum(Counts))
Tab_FINAL_R = as.data.frame(Tab_FINAL_R)
write.table(Tab_FINAL_R, paste0(WD, "/ALL/Database_LncRNAs_FINAL_R-all_species.tsv"), sep = "\t", col.names = T, row.names = F, quote = F)
gg = ggplot(Tab_FINAL_R, aes(x = Class_code, y = sum.Counts, fill = Significance_level)) +
geom_bar(position="stack", stat="identity") +
#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 36000), breaks = seq(0, 36000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(14000, 26000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
guides(fill=guide_legend(title="Confidence level")) +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 14),
axis.text.y = element_text(size = 14),
axis.title.y = element_text(size = 15),
strip.text.x = element_text(size = 17, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.text = element_text(size = 14),
legend.title = element_text(size = 14))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_R.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_R.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
### Non-Redundant
TAB_red_NR = TAB_NR[,c("ID_transcript", "Significance_level", "Class_code", "Specie")]
TAB_red_NR$"Counts" = 1
TAB_red_NR[TAB_red_NR == "o"] = "o/e"
TAB_red_NR[TAB_red_NR == "e"] = "o/e"
TAB_red_NR$Class_code = factor(TAB_red_NR$Class_code, levels = c("u", "x", "i", "o/e"))
TAB_red_NR$Significance_level = factor(TAB_red_NR$Significance_level, levels = c("Low", "Medium", "High"))
TAB_red_NR$Specie = factor(TAB_red_NR$Specie, levels = species_long_name)
Tab_FINAL_NR = TAB_red_NR %>%
group_by(Specie, Significance_level, Class_code, .drop=FALSE) %>%
summarise(
sum.Counts = sum(Counts))
Tab_FINAL_NR = as.data.frame(Tab_FINAL_NR)
write.table(Tab_FINAL_NR, paste0(WD, "/ALL/Database_LncRNAs_FINAL_NR-all_species"), sep = "\t", col.names = T, row.names = F, quote = F)
gg = ggplot(Tab_FINAL_NR, aes(x = Class_code, y = sum.Counts, fill = Significance_level)) +
geom_bar(position="stack", stat="identity") +
#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 25000), breaks = seq(0, 25000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(8000, 20000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
guides(fill=guide_legend(title="Confidence level")) +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 14),
axis.text.y = element_text(size = 14),
axis.title.y = element_text(size = 15),
strip.text.x = element_text(size = 17, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.text = element_text(size = 14),
legend.title = element_text(size = 14))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
##############################
# Draw Non-Redundant figure with the Redundant figure axis dimensions (Execute and then mute)
gg = ggplot(Tab_FINAL_NR, aes(x = Class_code, y = sum.Counts, fill = Significance_level)) +
geom_bar(position="stack", stat="identity") +
#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 25000), breaks = seq(0, 25000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(14000, 18000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
guides(fill=guide_legend(title="Confidence level")) +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 14),
axis.text.y = element_text(size = 14),
axis.title.y = element_text(size = 15),
strip.text.x = element_text(size = 17, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.text = element_text(size = 14),
legend.title = element_text(size = 14))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR_keep_axis.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR_keep_axis.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
################################################################################
#
# JOIN TABLES AND FIGURES
#
################################################################################
rm(list = ls())
## 0. INSTALL AND LOAD LIBRARIES
suppressMessages(options(bitmapType='cairo'))
suppressMessages(library("ggplot2"))
suppressMessages(library("ggbreak"))
suppressMessages(library("dplyr"))
## 1. VARIABLES
WD = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/05-predict_lncRNAs"
species_short_name = c("csa", "cme", "cla", "lsi", "cmo", "car", "cpe", "cma", "mch")
species_long_name = c("C. sativus", "C. melo", "C. lanatus", "L. siceraria", "C. moschata", "C. argyrosperma", "C. pepo", "C. maxima", "M. charantia")
if (!dir.exists(paste0(WD, "/ALL"))){
dir.create(paste0(WD, "/ALL"))
}
## 2. JOIN THE LNCRNAS DATABASE
TAB_R = data.frame()
TAB_NR = data.frame()
for (i in 1:length(species_short_name)) {
tab_R = read.table(paste0(WD, "/", species_short_name[i], "/STEP-FINAL/Database/Database_LncRNAs.tsv"), sep = "\t", header = T, quote = "\"")
tab_R$"Specie" = species_long_name[i]
tab_NR = read.table(paste0(WD, "/", species_short_name[i], "/STEP-FINAL/Database/Database_LncRNAs_NR.tsv"), sep = "\t", header = T, quote = "\"")
tab_NR$"Specie" = species_long_name[i]
TAB_R = rbind(TAB_R, tab_R)
TAB_NR = rbind(TAB_NR, tab_NR)
}
write.table(TAB_R, paste0(WD, "/ALL/Database_LncRNAs_R-all_species.tsv"), sep = "\t", col.names = T, row.names = F, quote = F)
write.table(TAB_NR, paste0(WD, "/ALL/Database_LncRNAs_NR-all_species.tsv"), sep = "\t", col.names = T, row.names = F, quote = F)
rm(list = c("i", "tab_R", "tab_NR"))
## 3. FIGURES
### Redundant
TAB_red_R = TAB_R[,c("ID_transcript", "Significance_level", "Class_code", "Specie")]
TAB_red_R$"Counts" = 1
TAB_red_R[TAB_red_R == "o"] = "o/e"
TAB_red_R[TAB_red_R == "e"] = "o/e"
TAB_red_R[TAB_red_R == "Low"] = "LC-lncRNA"
TAB_red_R[TAB_red_R == "Medium"] = "MC-lncRNA"
TAB_red_R[TAB_red_R == "High"] = "HC-lncRNA"
TAB_red_R$Class_code = factor(TAB_red_R$Class_code, levels = c("u", "x", "i", "o/e"))
TAB_red_R$Significance_level = factor(TAB_red_R$Significance_level, levels = c("LC-lncRNA", "MC-lncRNA", "HC-lncRNA"))
TAB_red_R$Specie = factor(TAB_red_R$Specie, levels = species_long_name)
Tab_FINAL_R = TAB_red_R %>%
group_by(Specie, Significance_level, Class_code, .drop=FALSE) %>%
summarise(
sum.Counts = sum(Counts))
Tab_FINAL_R = as.data.frame(Tab_FINAL_R)
write.table(Tab_FINAL_R, paste0(WD, "/ALL/Database_LncRNAs_FINAL_R-all_species.tsv"), sep = "\t", col.names = T, row.names = F, quote = F)
gg = ggplot(Tab_FINAL_R, aes(x = Class_code, y = sum.Counts, fill = Significance_level)) +
geom_bar(position="stack", stat="identity") +
#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 36000), breaks = seq(0, 36000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(14000, 26000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 16),
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 18),
strip.text.x = element_text(size = 18, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.title= element_blank(),
legend.text = element_text(size = 16))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_R.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_R.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
### Non-Redundant
TAB_red_NR = TAB_NR[,c("ID_transcript", "Significance_level", "Class_code", "Specie")]
TAB_red_NR$"Counts" = 1
TAB_red_NR[TAB_red_NR == "o"] = "o/e"
TAB_red_NR[TAB_red_NR == "e"] = "o/e"
TAB_red_NR[TAB_red_NR == "Low"] = "LC-lncRNA"
TAB_red_NR[TAB_red_NR == "Medium"] = "MC-lncRNA"
TAB_red_NR[TAB_red_NR == "High"] = "HC-lncRNA"
TAB_red_NR$Class_code = factor(TAB_red_NR$Class_code, levels = c("u", "x", "i", "o/e"))
TAB_red_NR$Significance_level = factor(TAB_red_NR$Significance_level, levels = c("LC-lncRNA", "MC-lncRNA", "HC-lncRNA"))
TAB_red_NR$Specie = factor(TAB_red_NR$Specie, levels = species_long_name)
Tab_FINAL_NR = TAB_red_NR %>%
group_by(Specie, Significance_level, Class_code, .drop=FALSE) %>%
summarise(
sum.Counts = sum(Counts))
Tab_FINAL_NR = as.data.frame(Tab_FINAL_NR)
write.table(Tab_FINAL_NR, paste0(WD, "/ALL/Database_LncRNAs_FINAL_NR-all_species"), sep = "\t", col.names = T, row.names = F, quote = F)
gg = ggplot(Tab_FINAL_NR, aes(x = Class_code, y = sum.Counts, fill = Significance_level)) +
geom_bar(position="stack", stat="identity") +
#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 25000), breaks = seq(0, 25000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(8000, 20000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 16),
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 18),
strip.text.x = element_text(size = 18, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.title= element_blank(),
legend.text = element_text(size = 16))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
##############################
# Draw Non-Redundant figure with the Redundant figure axis dimensions (Execute and then mute)
gg = ggplot(Tab_FINAL_NR, aes(x = Class_code, y = sum.Counts, fill = Significance_level)) +
geom_bar(position="stack", stat="identity") +
#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 25000), breaks = seq(0, 25000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(14000, 18000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 16),
axis.text.y = element_text(size = 16),
axis.title.y = element_text(size = 18),
strip.text.x = element_text(size = 18, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.title= element_blank(),
legend.text = element_text(size = 16))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR_keep_axis.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR_keep_axis.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
################################################################################
#
# JOIN TABLES AND FIGURES
#
################################################################################
rm(list = ls())
## 0. INSTALL AND LOAD LIBRARIES
suppressMessages(options(bitmapType='cairo'))
suppressMessages(library("ggplot2"))
suppressMessages(library("ggbreak"))
suppressMessages(library("dplyr"))
## 1. VARIABLES
WD = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/05-predict_lncRNAs"
species_short_name = c("csa", "cme", "cla", "lsi", "cmo", "car", "cpe", "cma", "mch")
species_long_name = c("C. sativus", "C. melo", "C. lanatus", "L. siceraria", "C. moschata", "C. argyrosperma", "C. pepo", "C. maxima", "M. charantia")
if (!dir.exists(paste0(WD, "/ALL"))){
dir.create(paste0(WD, "/ALL"))
}
## 2. JOIN THE LNCRNAS DATABASE
TAB_R = data.frame()
TAB_NR = data.frame()
for (i in 1:length(species_short_name)) {
tab_R = read.table(paste0(WD, "/", species_short_name[i], "/STEP-FINAL/Database/Database_LncRNAs.tsv"), sep = "\t", header = T, quote = "\"")
tab_R$"Specie" = species_long_name[i]
tab_NR = read.table(paste0(WD, "/", species_short_name[i], "/STEP-FINAL/Database/Database_LncRNAs_NR.tsv"), sep = "\t", header = T, quote = "\"")
tab_NR$"Specie" = species_long_name[i]
TAB_R = rbind(TAB_R, tab_R)
TAB_NR = rbind(TAB_NR, tab_NR)
}
write.table(TAB_R, paste0(WD, "/ALL/Database_LncRNAs_R-all_species.tsv"), sep = "\t", col.names = T, row.names = F, quote = F)
write.table(TAB_NR, paste0(WD, "/ALL/Database_LncRNAs_NR-all_species.tsv"), sep = "\t", col.names = T, row.names = F, quote = F)
rm(list = c("i", "tab_R", "tab_NR"))
## 3. FIGURES
### Redundant
TAB_red_R = TAB_R[,c("ID_transcript", "Significance_level", "Class_code", "Specie")]
TAB_red_R$"Counts" = 1
TAB_red_R[TAB_red_R == "o"] = "o/e"
TAB_red_R[TAB_red_R == "e"] = "o/e"
TAB_red_R[TAB_red_R == "Low"] = "LC-lncRNA"
TAB_red_R[TAB_red_R == "Medium"] = "MC-lncRNA"
TAB_red_R[TAB_red_R == "High"] = "HC-lncRNA"
TAB_red_R$Class_code = factor(TAB_red_R$Class_code, levels = c("u", "x", "i", "o/e"))
TAB_red_R$Significance_level = factor(TAB_red_R$Significance_level, levels = c("LC-lncRNA", "MC-lncRNA", "HC-lncRNA"))
TAB_red_R$Specie = factor(TAB_red_R$Specie, levels = species_long_name)
Tab_FINAL_R = TAB_red_R %>%
group_by(Specie, Significance_level, Class_code, .drop=FALSE) %>%
summarise(
sum.Counts = sum(Counts))
Tab_FINAL_R = as.data.frame(Tab_FINAL_R)
write.table(Tab_FINAL_R, paste0(WD, "/ALL/Database_LncRNAs_FINAL_R-all_species.tsv"), sep = "\t", col.names = T, row.names = F, quote = F)
gg = ggplot(Tab_FINAL_R, aes(x = Class_code, y = sum.Counts, fill = Significance_level)) +
geom_bar(position="stack", stat="identity") +
#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 36000), breaks = seq(0, 36000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(14000, 26000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
strip.text.x = element_text(size = 20, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.title= element_blank(),
legend.text = element_text(size = 18))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_R.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_R.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
### Non-Redundant
TAB_red_NR = TAB_NR[,c("ID_transcript", "Significance_level", "Class_code", "Specie")]
TAB_red_NR$"Counts" = 1
TAB_red_NR[TAB_red_NR == "o"] = "o/e"
TAB_red_NR[TAB_red_NR == "e"] = "o/e"
TAB_red_NR[TAB_red_NR == "Low"] = "LC-lncRNA"
TAB_red_NR[TAB_red_NR == "Medium"] = "MC-lncRNA"
TAB_red_NR[TAB_red_NR == "High"] = "HC-lncRNA"
TAB_red_NR$Class_code = factor(TAB_red_NR$Class_code, levels = c("u", "x", "i", "o/e"))
TAB_red_NR$Significance_level = factor(TAB_red_NR$Significance_level, levels = c("LC-lncRNA", "MC-lncRNA", "HC-lncRNA"))
TAB_red_NR$Specie = factor(TAB_red_NR$Specie, levels = species_long_name)
Tab_FINAL_NR = TAB_red_NR %>%
group_by(Specie, Significance_level, Class_code, .drop=FALSE) %>%
summarise(
sum.Counts = sum(Counts))
Tab_FINAL_NR = as.data.frame(Tab_FINAL_NR)
write.table(Tab_FINAL_NR, paste0(WD, "/ALL/Database_LncRNAs_FINAL_NR-all_species"), sep = "\t", col.names = T, row.names = F, quote = F)
gg = ggplot(Tab_FINAL_NR, aes(x = Class_code, y = sum.Counts, fill = Significance_level)) +
geom_bar(position="stack", stat="identity") +
#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 25000), breaks = seq(0, 25000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(8000, 20000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
strip.text.x = element_text(size = 20, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.title= element_blank(),
legend.text = element_text(size = 18))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
##############################
# Draw Non-Redundant figure with the Redundant figure axis dimensions (Execute and then mute)
gg = ggplot(Tab_FINAL_NR, aes(x = Class_code, y = sum.Counts, fill = Significance_level)) +
geom_bar(position="stack", stat="identity") +
#scale_fill_manual(values = c("#decfa9", "#dcb8b8", "#b5cf9b")) +
#scale_fill_manual(values = c("#0776AA", "#7AC1E3", "#C6E3F1")) +
#scale_fill_manual(values = c("#FFC32F", "#FFDD8B", "#FFF1D0")) +
#scale_fill_manual(values = c("#585858", "#9C9B9A", "#EBEBEB")) +
scale_fill_manual(values = c("#ce4fd3", "#eb92ef", "#edd0ee")) +
scale_y_continuous(limits = c(0, 25000), breaks = seq(0, 25000, by = 2000), expand = c(0.01,0.01)) +
scale_y_break(breaks=c(14000, 18000), scales = 0.15, expand = T) +
facet_wrap(Specie~., nrow = 1) +
xlab("") +
ylab("Number of LncRNAs") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(axis.text.x = element_text(vjust = 0.5, hjust=0.5, size = 18),
axis.text.y = element_text(size = 18),
axis.title.y = element_text(size = 22),
strip.text.x = element_text(size = 20, face = "bold.italic")) +
theme(legend.position = "bottom",
legend.title= element_blank(),
legend.text = element_text(size = 18))
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR_keep_axis.png"), height = 5, width = 25, dpi = 600)
ggsave(paste0(WD, "/ALL/Class_code_lncRNAs_counts_NR_keep_axis.pdf"), height = 5, width = 25, dpi = 600)
rm(list = c("gg"))
