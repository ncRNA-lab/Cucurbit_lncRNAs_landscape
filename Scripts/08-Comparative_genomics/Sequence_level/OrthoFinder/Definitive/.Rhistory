suppressMessages(library("UpSetR"))
suppressMessages(library("ggplot2"))
suppressMessages(library("dplyr"))
suppressMessages(library("ggbreak"))
options(bitmapType='cairo')
options(stringsAsFactors = F)
## 1. VARIABLES
flag = "nr"
WD1 = paste0("/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/08-comparative_genomics/Sequence_level/OrthoFinder/", flag, "/Definitive/05-Families")
WD2 = paste0("/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/08-comparative_genomics/Sequence_level/OrthoFinder/", flag, "/Definitive/06-Figures")
WD3 = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/06-quantification"
species = c("csa", "cme", "cla", "lsi", "cmo", "car", "cpe", "cma", "mch")
classes = c("ALL", "intergenic", "antisense", "intronic", "sense")
confidences = c("Low", "Medium", "High")
if (!dir.exists(WD2)){
dir.create(WD2)
}
cat("\nPlotting upsetr plots...\n")
confidence = "Low"
class = "antisense"
## LNCRNAS
Genpath = paste0(WD1, "/", confidence, "/", class, "/gen.tsv")
Gentab_all = read.table(Genpath, header = T, sep = "\t", quote = "\"")
# When we remove the UNCONSERVED lncRNAs (lncRNAs of families composed of a single lncRNA or several lncRNAs of a single
# specie if we have allowed paralogs. The last one are considered unconserved lncRNAs because we are studying conservation
# across the species), it's important to sort the columns (Species). UpsetR give an error if the first specie which appears
# in the table has 0 in all the rows. I mean, if the specie doesn't participate in any CONSERVED family, UpsetR will give us
# an error.
Gentab = Gentab_all[rowSums(Gentab_all[,3:dim(Gentab_all)[2]]) > 1, ]
View(Gentab)
check = as.data.frame(colSums(Famtab[,3:dim(Famtab)[2]]))
check$"Specie" = rownames(check)
