ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 3) {
TAB_LNCRNAS_NR_def$Type = factor(TAB_LNCRNAS_NR_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.1)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
}
}
}
cat("\n")
for (pipeline in c("Blastn", "OrthoFinder", "OrthoMCL")) {
for (confidence in confidences) {
for (i in c(1,2,3)) {
cat(paste0("\nPipeline: ", pipeline, " Confidence: ", confidence, " Table: ", i))
# Load the tables.
TAB_LNCRNAS_NR_def = read.table(paste0(WD1, "/", pipeline, "/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_", i, ".tsv"), sep = "\t", header = T, quote = "\"")
# Select by confidence level.
TAB_LNCRNAS_NR_def = TAB_LNCRNAS_NR_def[TAB_LNCRNAS_NR_def$Confidence == confidence,]
# Factors
TAB_LNCRNAS_NR_def$Class = factor(TAB_LNCRNAS_NR_def$Class, levels = classes)
TAB_LNCRNAS_NR_def$Specie = factor(TAB_LNCRNAS_NR_def$Specie, levels = species)
# Figures
if (i == 1) {
TAB_LNCRNAS_NR_def$Number_species_by_family = factor(TAB_LNCRNAS_NR_def$Number_species_by_family, levels = 1:length(species))
gg1 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Number_species_by_family)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5", "#e18727", "#20854e", "#7876b1", "#6f99ad", "#efc000", "#D87758", "#DDAFD6")) +
scale_y_continuous(expand = c(0.02, 0.1)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 14)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 2) {
TAB_LNCRNAS_NR_def$Conserved_level = factor(TAB_LNCRNAS_NR_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.1)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 14)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 3) {
TAB_LNCRNAS_NR_def$Type = factor(TAB_LNCRNAS_NR_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.1)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 14)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
}
}
}
cat("\n")
for (pipeline in c("Blastn", "OrthoFinder", "OrthoMCL")) {
for (confidence in confidences) {
for (i in c(1,2,3)) {
cat(paste0("\nPipeline: ", pipeline, " Confidence: ", confidence, " Table: ", i))
# Load the tables.
TAB_LNCRNAS_NR_def = read.table(paste0(WD1, "/", pipeline, "/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_", i, ".tsv"), sep = "\t", header = T, quote = "\"")
# Select by confidence level.
TAB_LNCRNAS_NR_def = TAB_LNCRNAS_NR_def[TAB_LNCRNAS_NR_def$Confidence == confidence,]
# Factors
TAB_LNCRNAS_NR_def$Class = factor(TAB_LNCRNAS_NR_def$Class, levels = classes)
TAB_LNCRNAS_NR_def$Specie = factor(TAB_LNCRNAS_NR_def$Specie, levels = species)
# Figures
if (i == 1) {
TAB_LNCRNAS_NR_def$Number_species_by_family = factor(TAB_LNCRNAS_NR_def$Number_species_by_family, levels = 1:length(species))
gg1 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Number_species_by_family)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5", "#e18727", "#20854e", "#7876b1", "#6f99ad", "#efc000", "#D87758", "#DDAFD6")) +
scale_y_continuous(expand = c(0.02, 0.1)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 9)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 2) {
TAB_LNCRNAS_NR_def$Conserved_level = factor(TAB_LNCRNAS_NR_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.1)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 9)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 3) {
TAB_LNCRNAS_NR_def$Type = factor(TAB_LNCRNAS_NR_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.1)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 9)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
}
}
}
for (pipeline in c("Blastn", "OrthoFinder", "OrthoMCL")) {
for (confidence in confidences) {
for (i in c(1,2,3)) {
cat(paste0("\nPipeline: ", pipeline, " Confidence: ", confidence, " Table: ", i))
# Load the tables.
TAB_LNCRNAS_NR_def = read.table(paste0(WD1, "/", pipeline, "/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_", i, ".tsv"), sep = "\t", header = T, quote = "\"")
# Select by confidence level.
TAB_LNCRNAS_NR_def = TAB_LNCRNAS_NR_def[TAB_LNCRNAS_NR_def$Confidence == confidence,]
# Factors
TAB_LNCRNAS_NR_def$Class = factor(TAB_LNCRNAS_NR_def$Class, levels = classes)
TAB_LNCRNAS_NR_def$Specie = factor(TAB_LNCRNAS_NR_def$Specie, levels = species)
# Figures
if (i == 1) {
TAB_LNCRNAS_NR_def$Number_species_by_family = factor(TAB_LNCRNAS_NR_def$Number_species_by_family, levels = 1:length(species))
gg1 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Number_species_by_family)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5", "#e18727", "#20854e", "#7876b1", "#6f99ad", "#efc000", "#D87758", "#DDAFD6")) +
scale_y_continuous(expand = c(0.02, 0.1)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 2) {
TAB_LNCRNAS_NR_def$Conserved_level = factor(TAB_LNCRNAS_NR_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.1)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 3) {
TAB_LNCRNAS_NR_def$Type = factor(TAB_LNCRNAS_NR_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.1)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
}
}
}
cat("\n\n\nOTHER FORMAT FIGURES")
### 8.1 Families
cat("\n\nFamilies")
if (!dir.exists(paste0(WD1, "/FINAL/Other_formats/Families"))){
dir.create(paste0(WD1, "/FINAL/Other_formats/Families"))
}
for (pipeline in c("Blastn", "OrthoFinder", "OrthoMCL")) {
for (confidence in confidences) {
for (i in c(1,2,3)) {
cat(paste0("\nPipeline: ", pipeline, " Confidence: ", confidence, " Table: ", i))
# Load the tables.
TAB_FAM_NR_def = read.table(paste0(WD1, "/", pipeline, "/nr/Definitive/06-Figures/TABLE_FAMILIES_PERCENTAGE_", i, ".tsv"), sep = "\t", header = T, quote = "\"")
# Select by confidence level.
TAB_FAM_NR_def = TAB_FAM_NR_def[TAB_FAM_NR_def$Confidence == confidence,]
# Factors
TAB_FAM_NR_def$Class = factor(TAB_FAM_NR_def$Class, levels = classes)
TAB_FAM_NR_def$Specie = factor(TAB_FAM_NR_def$Specie, levels = species)
# Figures
if (i == 1) {
TAB_FAM_NR_def$Number_species_by_family = factor(TAB_FAM_NR_def$Number_species_by_family, levels = 1:length(species))
gg1 = ggplot(TAB_FAM_NR_def, aes(x = Specie, y = Percentage_Families, fill = Number_species_by_family)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5", "#e18727", "#20854e", "#7876b1", "#6f99ad", "#efc000", "#D87758", "#DDAFD6")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/FINAL/Other_formats/Families/", pipeline, "-", confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/Families/", pipeline, "-", confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
if (i == 2) {
TAB_FAM_NR_def$Conserved_level = factor(TAB_FAM_NR_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_FAM_NR_def, aes(x = Specie, y = Percentage_Families, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/FINAL/Other_formats/Families/", pipeline, "-", confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/Families/", pipeline, "-", confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
if (i == 3) {
TAB_FAM_NR_def$Type = factor(TAB_FAM_NR_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_FAM_NR_def, aes(x = Specie, y = Percentage_Families, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/FINAL/Other_formats/Families/", pipeline, "-", confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/Families/", pipeline, "-", confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
}
}
}
### 8.2 LncRNAs
cat("\n\nLncRNAs")
if (!dir.exists(paste0(WD1, "/FINAL/Other_formats/LncRNAs"))){
dir.create(paste0(WD1, "/FINAL/Other_formats/LncRNAs"))
}
for (pipeline in c("Blastn", "OrthoFinder", "OrthoMCL")) {
for (confidence in confidences) {
for (i in c(1,2,3)) {
cat(paste0("\nPipeline: ", pipeline, " Confidence: ", confidence, " Table: ", i))
# Load the tables.
TAB_LNCRNAS_NR_def = read.table(paste0(WD1, "/", pipeline, "/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_", i, ".tsv"), sep = "\t", header = T, quote = "\"")
# Select by confidence level.
TAB_LNCRNAS_NR_def = TAB_LNCRNAS_NR_def[TAB_LNCRNAS_NR_def$Confidence == confidence,]
# Factors
TAB_LNCRNAS_NR_def$Class = factor(TAB_LNCRNAS_NR_def$Class, levels = classes)
TAB_LNCRNAS_NR_def$Specie = factor(TAB_LNCRNAS_NR_def$Specie, levels = species)
# Figures
if (i == 1) {
TAB_LNCRNAS_NR_def$Number_species_by_family = factor(TAB_LNCRNAS_NR_def$Number_species_by_family, levels = 1:length(species))
gg1 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Number_species_by_family)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5", "#e18727", "#20854e", "#7876b1", "#6f99ad", "#efc000", "#D87758", "#DDAFD6")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 2) {
TAB_LNCRNAS_NR_def$Conserved_level = factor(TAB_LNCRNAS_NR_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 3) {
TAB_LNCRNAS_NR_def$Type = factor(TAB_LNCRNAS_NR_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_LNCRNAS_NR_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/FINAL/Other_formats/LncRNAs/", pipeline, "-", confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
}
}
}
cat("\n")
suppressMessages(library("ggplot2"))
suppressMessages(library("dplyr"))
suppressMessages(library("ggvenn"))
options(bitmapType='cairo')
options(stringsAsFactors = F)
WD1 = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/08-comparative_genomics/Sequence_level"
species = c("csa", "cme", "cla", "lsi", "cmo", "car", "cpe", "cma", "mch")
classes = c("ALL", "intergenic", "antisense", "intronic", "sense")
confidences = c("Low", "Medium", "High")
cat("\n\n\nACCURACY BETWEEN PIPELINES COMPARISON")
### 7.1 LncRNAs: -max_target_seqs 1 and -max_hsps 1
cat("\n\nLncRNAs: -max_target_seqs 1 and -max_hsps 1")
if (!dir.exists(paste0(WD1, "/FINAL/Accuracy_comparison/LncRNAs"))){
dir.create(paste0(WD1, "/FINAL/Accuracy_comparison/LncRNAs"))
}
class = "High"
cat(paste0("\nClass: ", class))
# Load the tables.
TAB_LNCRNAS_BLASTN = read.table(paste0(WD1, "/Blastn/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
TAB_LNCRNAS_ORTHOFINDER = read.table(paste0(WD1, "/OrthoFinder/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
TAB_LNCRNAS_ORTHOMCL = read.table(paste0(WD1, "/OrthoMCL/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
View(TAB_LNCRNAS_BLASTN)
View(TAB_LNCRNAS_ORTHOFINDER)
# Select by class code.
TAB_LNCRNAS_Blastn_red = TAB_LNCRNAS_BLASTN[TAB_LNCRNAS_BLASTN$Class == class,]
TAB_LNCRNAS_OrthoFinder_red = TAB_LNCRNAS_ORTHOFINDER[TAB_LNCRNAS_ORTHOFINDER$Class == class,]
TAB_LNCRNAS_OrthoMCL_red = TAB_LNCRNAS_ORTHOMCL[TAB_LNCRNAS_ORTHOMCL$Class == class,]
level = "High-conserved"
ids_B = TAB_LNCRNAS_Blastn_red[TAB_LNCRNAS_Blastn_red$Conserved_level == level, "Member"]
ids_OF = TAB_LNCRNAS_OrthoFinder_red[TAB_LNCRNAS_OrthoFinder_red$Conserved_level == level, "Member"]
ids_OM = TAB_LNCRNAS_OrthoMCL_red[TAB_LNCRNAS_OrthoMCL_red$Conserved_level == level, "Member"]
View(TAB_LNCRNAS_Blastn_red)
View(TAB_LNCRNAS_BLASTN)
# Select by class code.
TAB_LNCRNAS_Blastn_red = TAB_LNCRNAS_BLASTN[TAB_LNCRNAS_BLASTN$Class == class,]
class = "intergenic"
TAB_LNCRNAS_Blastn_red = TAB_LNCRNAS_BLASTN[TAB_LNCRNAS_BLASTN$Class == class,]
TAB_LNCRNAS_OrthoFinder_red = TAB_LNCRNAS_ORTHOFINDER[TAB_LNCRNAS_ORTHOFINDER$Class == class,]
TAB_LNCRNAS_OrthoMCL_red = TAB_LNCRNAS_ORTHOMCL[TAB_LNCRNAS_ORTHOMCL$Class == class,]
level = "High-conserved"
ids_B = TAB_LNCRNAS_Blastn_red[TAB_LNCRNAS_Blastn_red$Conserved_level == level, "Member"]
ids_OF = TAB_LNCRNAS_OrthoFinder_red[TAB_LNCRNAS_OrthoFinder_red$Conserved_level == level, "Member"]
ids_OM = TAB_LNCRNAS_OrthoMCL_red[TAB_LNCRNAS_OrthoMCL_red$Conserved_level == level, "Member"]
# Select by class code.
TAB_LNCRNAS_Blastn_red = TAB_LNCRNAS_BLASTN[TAB_LNCRNAS_BLASTN$Class == class,]
TAB_LNCRNAS_OrthoFinder_red = TAB_LNCRNAS_ORTHOFINDER[TAB_LNCRNAS_ORTHOFINDER$Class == class,]
TAB_LNCRNAS_OrthoMCL_red = TAB_LNCRNAS_ORTHOMCL[TAB_LNCRNAS_ORTHOMCL$Class == class,]
# Figures
ids_B = TAB_LNCRNAS_Blastn_red[TAB_LNCRNAS_Blastn_red$Conserved_level != "Non-conserved", "Member"]
ids_OF = TAB_LNCRNAS_OrthoFinder_red[TAB_LNCRNAS_OrthoFinder_red$Conserved_level != "Non-conserved", "Member"]
ids_OM = TAB_LNCRNAS_OrthoMCL_red[TAB_LNCRNAS_OrthoMCL_red$Conserved_level != "Non-conserved", "Member"]
x = list(Blastn = ids_B, OrthoFinder = ids_OF, OrthoMCL = ids_OM)
png(filename = paste0(WD1, "/FINAL/Accuracy_comparison/LncRNAs/1-", class, ".png"), width = 3000, height = 3000, res = 500)
print(ggvenn(x, fill_color = c("#0073C2FF", "#EFC000FF", "#abd6bf"), stroke_size = 0.5, set_name_size = 4))
invisible(dev.off())
resultado <- setdiff(setdiff(ids_OF, ids_B), ids_OM)
resultado
TAB_LNCRNAS_OrthoFinder_red[TAB_LNCRNAS_OrthoFinder_red$Member == "MSTRG.52903.1-cme",]
resultado[grepl("MSTRG.52903.1-cme", resultado)]
ids_B
ids_OF
TAB_LNCRNAS_BLASTN[TAB_LNCRNAS_BLASTN$Member == "MSTRG.52903.1-cme",]
View(TAB_LNCRNAS_BLASTN)
################################################################################
#
# FIGURES: COMPARISON
#
################################################################################
rm(list = ls())
## 0. INSTALL AND LOAD LIBRARIES
suppressMessages(library("ggplot2"))
suppressMessages(library("dplyr"))
suppressMessages(library("ggvenn"))
options(bitmapType='cairo')
options(stringsAsFactors = F)
## 1. VARIABLES
WD1 = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/08-comparative_genomics/Sequence_level"
species = c("csa", "cme", "cla", "lsi", "cmo", "car", "cpe", "cma", "mch")
classes = c("ALL", "intergenic", "antisense", "intronic", "sense")
confidences = c("Low", "Medium", "High")
## 2. DIRECTORIES
if (!dir.exists(paste0(WD1, "/COMPARISON_SOFTWARES"))){
dir.create(paste0(WD1, "/COMPARISON_SOFTWARES"))
}
if (!dir.exists(paste0(WD1, "/COMPARISON_SOFTWARES/NR_and_R_comparison"))){
dir.create(paste0(WD1, "/COMPARISON_SOFTWARES/NR_and_R_comparison"))
}
if (!dir.exists(paste0(WD1, "/COMPARISON_SOFTWARES/Parameters_comparison"))){
dir.create(paste0(WD1, "/COMPARISON_SOFTWARES/Parameters_comparison"))
}
if (!dir.exists(paste0(WD1, "/COMPARISON_SOFTWARES/Pipelines_comparison"))){
dir.create(paste0(WD1, "/COMPARISON_SOFTWARES/Pipelines_comparison"))
}
if (!dir.exists(paste0(WD1, "/COMPARISON_SOFTWARES/Genes_and_LncRNAs_comparison"))){
dir.create(paste0(WD1, "/COMPARISON_SOFTWARES/Genes_and_LncRNAs_comparison"))
}
if (!dir.exists(paste0(WD1, "/COMPARISON_SOFTWARES/Accuracy_comparison"))){
dir.create(paste0(WD1, "/COMPARISON_SOFTWARES/Accuracy_comparison"))
}
if (!dir.exists(paste0(WD1, "/COMPARISON_SOFTWARES/Other_formats"))){
dir.create(paste0(WD1, "/COMPARISON_SOFTWARES/Other_formats"))
}
cat("\n\n\nACCURACY BETWEEN PIPELINES COMPARISON")
### 7.1 LncRNAs: -max_target_seqs 1 and -max_hsps 1
cat("\n\nLncRNAs: -max_target_seqs 1 and -max_hsps 1")
classes
class = "ALL"
cat(paste0("\nClass: ", class))
# Load the tables.
TAB_LNCRNAS_BLASTN = read.table(paste0(WD1, "/Blastn/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
TAB_LNCRNAS_ORTHOFINDER = read.table(paste0(WD1, "/OrthoFinder/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
TAB_LNCRNAS_ORTHOMCL = read.table(paste0(WD1, "/OrthoMCL/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
# Select by class code.
TAB_LNCRNAS_Blastn_red = TAB_LNCRNAS_BLASTN[TAB_LNCRNAS_BLASTN$Class == class,]
TAB_LNCRNAS_OrthoFinder_red = TAB_LNCRNAS_ORTHOFINDER[TAB_LNCRNAS_ORTHOFINDER$Class == class,]
TAB_LNCRNAS_OrthoMCL_red = TAB_LNCRNAS_ORTHOMCL[TAB_LNCRNAS_ORTHOMCL$Class == class,]
# Figures
ids_B = TAB_LNCRNAS_Blastn_red[TAB_LNCRNAS_Blastn_red$Conserved_level != "Non-conserved", "Member"]
ids_OF = TAB_LNCRNAS_OrthoFinder_red[TAB_LNCRNAS_OrthoFinder_red$Conserved_level != "Non-conserved", "Member"]
ids_OM = TAB_LNCRNAS_OrthoMCL_red[TAB_LNCRNAS_OrthoMCL_red$Conserved_level != "Non-conserved", "Member"]
View(TAB_LNCRNAS_OrthoMCL_red)
TAB_LNCRNAS_BLASTN = read.table(paste0(WD1, "/Blastn/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
TAB_LNCRNAS_ORTHOFINDER = read.table(paste0(WD1, "/OrthoFinder/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
TAB_LNCRNAS_ORTHOMCL = read.table(paste0(WD1, "/OrthoMCL/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
# Select by class code.
TAB_LNCRNAS_Blastn_red = TAB_LNCRNAS_BLASTN[TAB_LNCRNAS_BLASTN$Class == class,]
TAB_LNCRNAS_OrthoFinder_red = TAB_LNCRNAS_ORTHOFINDER[TAB_LNCRNAS_ORTHOFINDER$Class == class,]
TAB_LNCRNAS_OrthoMCL_red = TAB_LNCRNAS_ORTHOMCL[TAB_LNCRNAS_ORTHOMCL$Class == class,]
# Figures
ids_B = TAB_LNCRNAS_Blastn_red[TAB_LNCRNAS_Blastn_red$Conserved_level != "Non-conserved", "Member"]
ids_OF = TAB_LNCRNAS_OrthoFinder_red[TAB_LNCRNAS_OrthoFinder_red$Conserved_level != "Non-conserved", "Member"]
ids_OM = TAB_LNCRNAS_OrthoMCL_red[TAB_LNCRNAS_OrthoMCL_red$Conserved_level != "Non-conserved", "Member"]
# Load the tables.
TAB_LNCRNAS_BLASTN = read.table(paste0(WD1, "/Blastn/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
TAB_LNCRNAS_ORTHOFINDER = read.table(paste0(WD1, "/OrthoFinder/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
TAB_LNCRNAS_ORTHOMCL = read.table(paste0(WD1, "/OrthoMCL/nr/Definitive/06-Figures/TABLE_LNCRNAS_PERCENTAGE_ALL.tsv"), sep = "\t", header = T, quote = "\"")
# Select by class code.
TAB_LNCRNAS_Blastn_red = TAB_LNCRNAS_BLASTN[TAB_LNCRNAS_BLASTN$Class == class,]
TAB_LNCRNAS_OrthoFinder_red = TAB_LNCRNAS_ORTHOFINDER[TAB_LNCRNAS_ORTHOFINDER$Class == class,]
TAB_LNCRNAS_OrthoMCL_red = TAB_LNCRNAS_ORTHOMCL[TAB_LNCRNAS_ORTHOMCL$Class == class,]
# Figures
ids_B = TAB_LNCRNAS_Blastn_red[TAB_LNCRNAS_Blastn_red$Conserved_level != "Non-conserved", "Member"]
ids_OF = TAB_LNCRNAS_OrthoFinder_red[TAB_LNCRNAS_OrthoFinder_red$Conserved_level != "Non-conserved", "Member"]
ids_OM = TAB_LNCRNAS_OrthoMCL_red[TAB_LNCRNAS_OrthoMCL_red$Conserved_level != "Non-conserved", "Member"]
length(unique(ids_B, ids_OF, ids_OM))
length(unique(c(ids_B, ids_OF, ids_OM)))
