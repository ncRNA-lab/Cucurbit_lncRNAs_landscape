if (i == 2) {
TAB_LNCRNAS_def$Conserved_level = factor(TAB_LNCRNAS_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_LNCRNAS_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 3) {
TAB_LNCRNAS_def$Type = factor(TAB_LNCRNAS_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_LNCRNAS_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
}
}
################################################################################
## 1. OTHER FORMAT FIGURES
cat("\n\n\nOTHER FORMAT FIGURES")
### 1.1 Families
cat("\n\nFamilies")
if (!dir.exists(paste0(WD1, "/", flag, "/07-Other_formats/Families"))){
dir.create(paste0(WD1, "/", flag, "/07-Other_formats/Families"))
}
for (confidence in confidences) {
for (i in c(1,2,3)) {
cat(paste0("\nConfidence: ", confidence, " Table: ", i))
# Load the tables.
TAB_FAM_def = read.table(paste0(WD1, "/", flag, "/05-Figures/TABLE_FAMILIES_PERCENTAGE_", i, ".tsv"), sep = "\t", header = T, quote = "\"")
# Select by confidence level, strictness and nonmatch info.
TAB_FAM_def = TAB_FAM_def[TAB_FAM_def$Confidence == confidence & TAB_FAM_def$Strictness == "ORIGINAL" & TAB_FAM_def$NonMatch == "no",]
# Factors
TAB_FAM_def$Class = factor(TAB_FAM_def$Class, levels = classes)
TAB_FAM_def$Specie = factor(TAB_FAM_def$Specie, levels = species)
# Figures
if (i == 1) {
TAB_FAM_def$Number_species_by_family = factor(TAB_FAM_def$Number_species_by_family, levels = 1:length(species))
gg1 = ggplot(TAB_FAM_def, aes(x = Specie, y = Percentage_Families, fill = Number_species_by_family)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5", "#e18727", "#20854e", "#7876b1", "#6f99ad", "#efc000", "#D87758", "#DDAFD6")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
if (i == 2) {
TAB_FAM_def$Conserved_level = factor(TAB_FAM_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_FAM_def, aes(x = Specie, y = Percentage_Families, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
if (i == 3) {
TAB_FAM_def$Type = factor(TAB_FAM_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_FAM_def, aes(x = Specie, y = Percentage_Families, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
}
}
### 8.2 LncRNAs
cat("\n\nLncRNAs")
if (!dir.exists(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs"))){
dir.create(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs"))
}
for (confidence in confidences) {
for (i in c(1,2,3)) {
cat(paste0("\nConfidence: ", confidence, " Table: ", i))
# Load the tables.
TAB_LNCRNAS_def = read.table(paste0(WD1, "/", flag, "/05-Figures/TABLE_LNCRNAS_PERCENTAGE_", i, ".tsv"), sep = "\t", header = T, quote = "\"")
# Select by confidence level, strictness and nonmatch info.
TAB_LNCRNAS_def = TAB_LNCRNAS_def[TAB_LNCRNAS_def$Confidence == confidence & TAB_LNCRNAS_def$Strictness == "ORIGINAL" & TAB_LNCRNAS_def$NonMatch == "no",]
# Factors
TAB_LNCRNAS_def$Class = factor(TAB_LNCRNAS_def$Class, levels = classes)
TAB_LNCRNAS_def$Specie = factor(TAB_LNCRNAS_def$Specie, levels = species)
# Figures
if (i == 1) {
TAB_LNCRNAS_def$Number_species_by_family = factor(TAB_LNCRNAS_def$Number_species_by_family, levels = 1:length(species))
gg1 = ggplot(TAB_LNCRNAS_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Number_species_by_family)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5", "#e18727", "#20854e", "#7876b1", "#6f99ad", "#efc000", "#D87758", "#DDAFD6")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 2) {
TAB_LNCRNAS_def$Conserved_level = factor(TAB_LNCRNAS_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_LNCRNAS_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 3) {
TAB_LNCRNAS_def$Type = factor(TAB_LNCRNAS_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_LNCRNAS_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/07-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
}
}
cat("\n")
################################################################################
#
# FIGURES: OTHER FORMAT
#
################################################################################
rm(list = ls())
## 0. INSTALL AND LOAD LIBRARIES
suppressMessages(library("ggplot2"))
suppressMessages(library("dplyr"))
suppressMessages(library("ggvenn"))
options(bitmapType='cairo')
options(stringsAsFactors = F)
## 1. VARIABLES
WD1 = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/08-comparative_genomics/Positional_level/Approach_2"
species = c("csa", "cme", "cla", "lsi", "cmo", "car", "cpe", "cma", "mch")
classes = c("ALL", "intergenic", "antisense", "intronic", "sense")
confidences = c("Low", "Medium", "High")
flag = "nr"
## 2. DIRECTORIES
if (!dir.exists(paste0(WD1, "/nr"))){
dir.create(paste0(WD1, "/nr"))
}
if (!dir.exists(paste0(WD1, "/", flag, "/06-Other_formats"))){
dir.create(paste0(WD1, "/", flag, "/06-Other_formats"))
}
################################################################################
## 1. OTHER FORMAT FIGURES
cat("\n\n\nOTHER FORMAT FIGURES")
### 1.1 Families
cat("\n\nFamilies")
if (!dir.exists(paste0(WD1, "/", flag, "/06-Other_formats/Families"))){
dir.create(paste0(WD1, "/", flag, "/06-Other_formats/Families"))
}
for (confidence in confidences) {
for (i in c(1,2,3)) {
cat(paste0("\nConfidence: ", confidence, " Table: ", i))
# Load the tables.
TAB_FAM_def = read.table(paste0(WD1, "/", flag, "/05-Figures/TABLE_FAMILIES_PERCENTAGE_", i, ".tsv"), sep = "\t", header = T, quote = "\"")
# Select by confidence level, strictness and nonmatch info.
TAB_FAM_def = TAB_FAM_def[TAB_FAM_def$Confidence == confidence & TAB_FAM_def$Strictness == "ORIGINAL" & TAB_FAM_def$NonMatch == "no",]
# Factors
TAB_FAM_def$Class = factor(TAB_FAM_def$Class, levels = classes)
TAB_FAM_def$Specie = factor(TAB_FAM_def$Specie, levels = species)
# Figures
if (i == 1) {
TAB_FAM_def$Number_species_by_family = factor(TAB_FAM_def$Number_species_by_family, levels = 1:length(species))
gg1 = ggplot(TAB_FAM_def, aes(x = Specie, y = Percentage_Families, fill = Number_species_by_family)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5", "#e18727", "#20854e", "#7876b1", "#6f99ad", "#efc000", "#D87758", "#DDAFD6")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
if (i == 2) {
TAB_FAM_def$Conserved_level = factor(TAB_FAM_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_FAM_def, aes(x = Specie, y = Percentage_Families, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
if (i == 3) {
TAB_FAM_def$Type = factor(TAB_FAM_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_FAM_def, aes(x = Specie, y = Percentage_Families, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
}
}
### 8.2 LncRNAs
cat("\n\nLncRNAs")
if (!dir.exists(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs"))){
dir.create(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs"))
}
for (confidence in confidences) {
for (i in c(1,2,3)) {
cat(paste0("\nConfidence: ", confidence, " Table: ", i))
# Load the tables.
TAB_LNCRNAS_def = read.table(paste0(WD1, "/", flag, "/05-Figures/TABLE_LNCRNAS_PERCENTAGE_", i, ".tsv"), sep = "\t", header = T, quote = "\"")
# Select by confidence level, strictness and nonmatch info.
TAB_LNCRNAS_def = TAB_LNCRNAS_def[TAB_LNCRNAS_def$Confidence == confidence & TAB_LNCRNAS_def$Strictness == "ORIGINAL" & TAB_LNCRNAS_def$NonMatch == "no",]
# Factors
TAB_LNCRNAS_def$Class = factor(TAB_LNCRNAS_def$Class, levels = classes)
TAB_LNCRNAS_def$Specie = factor(TAB_LNCRNAS_def$Specie, levels = species)
# Figures
if (i == 1) {
TAB_LNCRNAS_def$Number_species_by_family = factor(TAB_LNCRNAS_def$Number_species_by_family, levels = 1:length(species))
gg1 = ggplot(TAB_LNCRNAS_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Number_species_by_family)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5", "#e18727", "#20854e", "#7876b1", "#6f99ad", "#efc000", "#D87758", "#DDAFD6")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 2) {
TAB_LNCRNAS_def$Conserved_level = factor(TAB_LNCRNAS_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_LNCRNAS_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 3) {
TAB_LNCRNAS_def$Type = factor(TAB_LNCRNAS_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_LNCRNAS_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
}
}
cat("\n")
################################################################################
#
# FIGURES: OTHER FORMAT
#
################################################################################
rm(list = ls())
## 0. INSTALL AND LOAD LIBRARIES
suppressMessages(library("ggplot2"))
suppressMessages(library("dplyr"))
suppressMessages(library("ggvenn"))
options(bitmapType='cairo')
options(stringsAsFactors = F)
## 1. VARIABLES
WD1 = "/mnt/doctorado/3-lncRNAs/Cucurbitaceae/Results/08-comparative_genomics/Positional_level/Approach_2"
species = c("csa", "cme", "cla", "lsi", "cmo", "car", "cpe", "cma", "mch")
classes = c("ALL", "intergenic", "antisense", "intronic", "sense")
confidences = c("Low", "Medium", "High")
flag = "r"
## 2. DIRECTORIES
if (!dir.exists(paste0(WD1, "/nr"))){
dir.create(paste0(WD1, "/nr"))
}
if (!dir.exists(paste0(WD1, "/", flag, "/06-Other_formats"))){
dir.create(paste0(WD1, "/", flag, "/06-Other_formats"))
}
################################################################################
## 1. OTHER FORMAT FIGURES
cat("\n\n\nOTHER FORMAT FIGURES")
### 1.1 Families
cat("\n\nFamilies")
if (!dir.exists(paste0(WD1, "/", flag, "/06-Other_formats/Families"))){
dir.create(paste0(WD1, "/", flag, "/06-Other_formats/Families"))
}
for (confidence in confidences) {
for (i in c(1,2,3)) {
cat(paste0("\nConfidence: ", confidence, " Table: ", i))
# Load the tables.
TAB_FAM_def = read.table(paste0(WD1, "/", flag, "/05-Figures/TABLE_FAMILIES_PERCENTAGE_", i, ".tsv"), sep = "\t", header = T, quote = "\"")
# Select by confidence level, strictness and nonmatch info.
TAB_FAM_def = TAB_FAM_def[TAB_FAM_def$Confidence == confidence & TAB_FAM_def$Strictness == "ORIGINAL" & TAB_FAM_def$NonMatch == "no",]
# Factors
TAB_FAM_def$Class = factor(TAB_FAM_def$Class, levels = classes)
TAB_FAM_def$Specie = factor(TAB_FAM_def$Specie, levels = species)
# Figures
if (i == 1) {
TAB_FAM_def$Number_species_by_family = factor(TAB_FAM_def$Number_species_by_family, levels = 1:length(species))
gg1 = ggplot(TAB_FAM_def, aes(x = Specie, y = Percentage_Families, fill = Number_species_by_family)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5", "#e18727", "#20854e", "#7876b1", "#6f99ad", "#efc000", "#D87758", "#DDAFD6")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
if (i == 2) {
TAB_FAM_def$Conserved_level = factor(TAB_FAM_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_FAM_def, aes(x = Specie, y = Percentage_Families, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
if (i == 3) {
TAB_FAM_def$Type = factor(TAB_FAM_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_FAM_def, aes(x = Specie, y = Percentage_Families, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_Families), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".png"), height = 12, width = 6, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/Families/",confidence, "-stacked_barplot_Families_", i, ".pdf"), height = 12, width = 6, dpi = 700)
}
}
}
### 8.2 LncRNAs
cat("\n\nLncRNAs")
if (!dir.exists(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs"))){
dir.create(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs"))
}
for (confidence in confidences) {
for (i in c(1,2,3)) {
cat(paste0("\nConfidence: ", confidence, " Table: ", i))
# Load the tables.
TAB_LNCRNAS_def = read.table(paste0(WD1, "/", flag, "/05-Figures/TABLE_LNCRNAS_PERCENTAGE_", i, ".tsv"), sep = "\t", header = T, quote = "\"")
# Select by confidence level, strictness and nonmatch info.
TAB_LNCRNAS_def = TAB_LNCRNAS_def[TAB_LNCRNAS_def$Confidence == confidence & TAB_LNCRNAS_def$Strictness == "ORIGINAL" & TAB_LNCRNAS_def$NonMatch == "no",]
# Factors
TAB_LNCRNAS_def$Class = factor(TAB_LNCRNAS_def$Class, levels = classes)
TAB_LNCRNAS_def$Specie = factor(TAB_LNCRNAS_def$Specie, levels = species)
# Figures
if (i == 1) {
TAB_LNCRNAS_def$Number_species_by_family = factor(TAB_LNCRNAS_def$Number_species_by_family, levels = 1:length(species))
gg1 = ggplot(TAB_LNCRNAS_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Number_species_by_family)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5", "#e18727", "#20854e", "#7876b1", "#6f99ad", "#efc000", "#D87758", "#DDAFD6")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 2) {
TAB_LNCRNAS_def$Conserved_level = factor(TAB_LNCRNAS_def$Conserved_level, levels = c("Non-conserved", "Low-conserved", "Medium-conserved", "High-conserved"))
gg2 = ggplot(TAB_LNCRNAS_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Conserved_level)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#FFFFFF", "#CEEBF7", "#569DBD", "#18485D")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
if (i == 3) {
TAB_LNCRNAS_def$Type = factor(TAB_LNCRNAS_def$Type, levels = c("Non-conserved", "Conserved"))
gg3 = ggplot(TAB_LNCRNAS_def, aes(x = Specie, y = Percentage_LncRNAs, fill = Type)) +
geom_bar(colour = "black", position="fill", stat="identity") +
facet_grid(Class ~ .) +
scale_fill_manual(values = c("#bc3c29", "#0072b5")) +
scale_y_continuous(expand = c(0.02, 0.08)) +
xlab("") +
ylab("Percentage (%)") +
theme_bw() +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank()) +
theme(legend.position = "top") +
guides(fill = guide_legend(nrow = 2, title = "Conservation level")) +
geom_text(aes(y = 1, label = Total_LncRNAs), vjust = -0.3, size = 3)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".png"), height = 12, width = 5, dpi = 700)
ggsave(paste0(WD1, "/", flag, "/06-Other_formats/LncRNAs/",confidence, "-stacked_barplot_LncRNAs_", i, ".pdf"), height = 12, width = 5, dpi = 700)
}
}
}
cat("\n")
